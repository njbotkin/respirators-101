<div class="chemical { (search ? $job.openChemicals[i] : open) && 'open' }">
	<div class="title" on:click="toggleOpen()">
		<span class="name">{ @html search ? name : (nameHighlit || name) }</span>
		{ #if synonyms }
			<span class="synonyms">({ @html search ? synonyms : (synonymsHighlit || synonyms) })</span>
		{ /if }
	</div>

	{ #if (search ? $job.openChemicals[i] : open) }

		<div class="contents">

			{ #if cas }
				<div class="property inline">
					<div class="label">CAS</div>
					<div class="value">{ @html cas }</div>
				</div>
			{ /if }

			{ #if idlh }
				<div class="property inline">
					<div class="label">IDLH</div>
					<div class="value">{ @html idlh }</div>
					<div class="notes">{ @html idlh_notes }</div>
				</div>
			{ /if }

			{ #if general_standard }
				<div class="property">
					<div class="label">General Standard</div>
					{#each general_standard as s}
						<div class="value">{ @html s }</div>
					{/each}
				</div>
			{ /if }

			{ #if one_ppm_in_mgm3 }
			<div class="property inline">
				<div class="label">Conversion</div>
					
				<div class="equation value" style="font-size:70%">
					<div class="operand">
						<div class="value">1</div>
						<div class="unit">ppm</div>
					</div>

					<div class="operator">=</div>

					<div class="operand">
						<div class="value">{ one_ppm_in_mgm3 }</div>
						<div class="unit">mg/m<sup>3</sup></div>
					</div>
				</div>
			</div>
			{ /if }

			{#if standards}

			<h2>Exposure Limits</h2>
			<div class="instructions">Select a number to select an exposure limit.</div>

			<ExposureLimits {idlh} {idlh_notes} {eyes} chemical_name="{name}" standards="{standards}" on:confirmSaveEL showKeys="true" />

			{/if}

			{ #if z3 }<div class="z3">See more information in the <a href="https://www.osha.gov/dsg/annotated-pels/tablez-3.html">OSHA Annotated Table Z-3</a></div>{ /if }

			{#if physical_description}
				<div class="block">
					<label>Physical Description</label>
					{@html physical_description }
				</div>
			{/if}

			{#if exposure_routes}
				<table>
					<tr>
						<td style="padding-left: 0">
							<label>Exposure Routes</label>
							{@html exposure_routes }
						</td>
						<td style="padding-right: 0">
							<label>Target Organs</label>
							{@html target_organs }
						</td>
					</tr>
				</table>
			{/if}

			{#if pp}
				<div class="block supsection">
					<label style="font-size: 90%">Personal Protection/Sanitation</label>

					<table>	
						<tr><td><label> Skin		</label></td><td>{@html ps }</td></tr>
						<tr><td><label> Eyes		</label></td><td>{@html pe }</td></tr>
						<tr><td><label> Wash Skin	</label></td><td>{@html pw }</td></tr>
						<tr><td><label> Remove		</label></td><td>{@html pr }</td></tr>
						<tr><td><label> Change		</label></td><td>{@html pc }</td></tr>
						<tr><td><label> Provide		</label></td><td>{@html pp }</td></tr>
					</table>
				</div>
			{/if}

			<div class="sources">
				<h2>Sources</h2>
				{#if npg}<a href="https://www.cdc.gov/niosh/npg/default.html">NIOSH Pocket Guide to Chemical Hazards</a><br>{/if}
				{ #if z1 }<a href="https://www.osha.gov/dsg/annotated-pels/tablez-1.html">OSHA Annotated Table Z-1</a><br>{ /if }
				{ #if z2 }<a href="https://www.osha.gov/dsg/annotated-pels/tablez-2.html">OSHA Annotated Table Z-2</a><br>{ /if }
			</div>

		</div>

	{ /if }

</div>

<script>
	export default {
		components: {
			ExposureLimits: 'lib/ExposureLimits.html'
		},
		methods: {
			toggleOpen() {
				let { i, open, search } = this.get()
				open = !open 
				this.set({ open })

				if(search) {
					let { job } = this.store.get()
					if(job.openChemicals[i]) {
						delete job.openChemicals[i]
					} else {
						job.openChemicals[i] = 1
					}
					this.store.set({ job })
				}
			}
		}
	}
</script>

<style>

	@import 'colors';

	.chemical {
		padding: 5px 20px;
		transition: all .2s;

		.title {
			cursor: pointer;

			:global(em) {
				font-weight: bold;
				font-style: normal;
			}
		}

		@media screen and (max-width: 600px) {
			padding: 5px 10px;
		}

		.contents {
			margin-top: 10px;
			border-top: 1px solid #ddd;
			padding-top: 5px;

			@media screen and (max-width: 600px) {
				margin-top: 5px;
			}
		}

		&.open {
			background: #fff; 
			margin: 5px 0;
			padding: 10px 20px;
			box-shadow: 1px 1px 10px rgba(0,0,0,0.06);

			@media screen and (max-width: 600px) {
				padding: 5px 10px;
			}
		}
	}

	h2 {
		font-size: 120%;
		margin: 0;
	}
	.instructions {
		font-size: 90%;
		color: #888;
		margin: 0 0 10px 0;
	}

	.top-blocks td {
		width: 33%;
	}

	.block {
		margin: 20px 0;
	}

	.supsection {
		/*border-bottom: 1px solid #ddd;*/

		> label {
			/*border-bottom: 1px solid #ddd;*/
			padding-bottom: 5px;
		}
	}

	label {
		display:block;
		font-weight: bold;
		font-size: 80%;
	}

	.protection label {
		display: inline;
	}

	.synonyms {
		font-size: 80%;
		color: #aaa;
	}

	table td {
		padding: 0 5px;
	}

	.sources {
		margin-top: 10px;
		font-size: 80%;
		line-height: 2;
		h2 {
			font-size: 100%;
			margin: 0;
			border-bottom: 1px solid #ddd;
		}
	}

	.z3 {
		text-align: center;
		margin: 20px 0;
		font-size: 120%;
	}

</style>