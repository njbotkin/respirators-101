<div class="chemical open{open}">
	<div class="title" on:click="set({ open: !open })" id="{ c.id || '' }">
		<span class="name">{@html (highlight && c.nameHighlit) || c.name }</span>
		{ #if c.synonyms }
			<span class="synonyms">({@html (highlight && c.synonymsHighlit) || c.synonyms })</span>
		{ /if }
	</div>

	{ #if open } <!-- lots faster than simply hiding -->

		<div class="contents">

			<div class="property inline">
				<div class="label">CAS</div>
				<div class="value">{ @html c.cas }</div>
			</div>

			<div class="property inline">
				<div class="label">IDLH</div>
				<div class="value">{ @html c.idlh }</div>
				<div class="notes">{ @html c.idlh_notes }</div>
			</div>

			{ #if c.one_ppm_in_mgm3 }
			<div class="property inline">
				<div class="label">Conversion</div>
					
				<div class="equation value">
					<div class="operand">
						<div class="value">1</div>
						<div class="unit">ppm</div>
					</div>

					<div class="operator">=</div>

					<div class="operand">
						<div class="value">{ c.one_ppm_in_mgm3 }</div>
						<div class="unit">mg/m<sup>3</sup></div>
					</div>
				</div>
			</div>
			{ /if }

			<h2>Exposure Limits</h2>
			<div class="keys">
				<div class="key form">Form</div>
				<div class="key standard">Standard</div>
				<div class="key EL">Exposure Limit</div>
			</div>

			<div class="property-list">
				{ #each Object.entries(c.forms) as [formKey, standards] }

					<div class="property color-form"> 

						{ #if formKey !== 'regular' }<div class="label">{ formKey.toUpperCase() }</div>{ /if }

						<div class="value">

							{ #each Object.entries(standards) as [standardKey, standard] }

								<div class="property color-standard">
	
									<div class="label">{ standardsPretty[standardKey] }</div>

									<div class="value property-list">

										{ #if standard.durations }{ #each Object.entries(standard.durations) as [durationKey, duration] }

											<div class="property inline color-EL EL" on:click="set({'path': [formKey, standardKey, durationKey]})">
												<div class="label">{ durationsPretty[durationKey] }</div>
												<div class="value">
													{ #if duration.ppm }
														<UnitRepresentation number="{ duration.ppm }" unit="PPM" />
													{ /if }

													{ #if duration.mgm3 }
														<UnitRepresentation number="{ duration.mgm3 }" unit="mg/m<sup>3</sup>" />
													{ /if }
												</div>
											</div>

										{ /each }{ /if }

									</div>

									{ #if standard.carcinogens }
										<span class="carcinogens">carcinogens</span>
									{ /if }

									{ #if standard.znotes }
										{ #each standard.znotes as znote }
											<div class="notes">{@html znote }</div>
										{ /each }
									{ :elseif standard.notes }
										{ #each standard.notes as note }
											<div class="notes">{@html note }</div>
										{ /each }
									{ /if }

								</div>

							{ /each }

						</div>

					</div>

				{ /each }
			</div>

			{ #if path.length > 0 }
				Selected Exposure Limit: <span class="form">{ path[0] }</span> -> <span class="standard">{ standardsPretty[path[1]] }</span> -> <span class="EL">{ durationsPretty[path[2]] }</span>
			{ /if }

			<div class="block">
				<label>Physical Description</label>
				{@html c.physical_description }
			</div>

			<table>
				<tr>
					<td>
						<label>Exposure Routes</label>
						{@html c.exposure_routes }
					</td>
					<td>
						<label>Target Organs</label>
						{@html c.target_organs }
					</td>
				</tr>
			</table>

			<div class="block supsection">
				<label>Personal Protection/Sanitation</label>

				<table class="table">	
					<tr><td><label>Skin		</label></td><td>{@html c.ps }</td></tr>
					<tr><td><label>Eyes		</label></td><td>{@html c.pe }</td></tr>
					<tr><td><label>Wash	Skin</label></td><td>{@html c.pw }</td></tr>
					<tr><td><label>Remove	</label></td><td>{@html c.pr }</td></tr>
					<tr><td><label>Change	</label></td><td>{@html c.pc }</td></tr>
					<tr><td><label>Provide	</label></td><td>{@html c.pp }</td></tr>
				</table>
			</div>

		</div>

	{ /if }

</div>

<style>

	@import 'colors';

	$formSolid: $yellow1;
	$formText: $yellow2;

	$standardSolid: #8392ca;
	$standardText: #7580AA;

	$ELSolid: $red1;
	$ELText: #ce817f;

	:global(.chemical) {
		.title {
			cursor: pointer;

			em {
				font-weight: bold;
				font-style: normal;
			}
		}
	} 

	h2 {
		font-size: 120%;
		margin: 10px 0;
	}
	.key {
		display: inline-block;
		line-height: 1;
		border-left: 12px solid;
		font-size: 12px;
		font-weight: bold;
		padding: 0 4px;
	}

	.form {
		border-color: $formSolid;
		color: $formText;
	}

	.standard {
		border-color: $standardSolid;
		color: $standardText;
	}

	.EL {
		border-color: $ELSolid;
		color: $ELText;
	}


	.property {
		display: inline-block;
    	vertical-align: top;
		border-left: 2px solid transparent;
    	padding: 5px 10px;
    	margin: 5px 0;

		.label {
			font-size: 80%;
			font-weight: bold;
			display: block;
			padding-right: 5px;
		}
		.notes {
			display: block;
			font-size: 70%;
			opacity: .8;
		}
	}

	.property.color-form {
		border-left-color: $formSolid;
		color: $formText; 
	}

	.property.color-standard {
		border-left-color: $standardSolid;
		color: $standardText;
	}

	.property.color-EL {
		border-left-color: $ELSolid;
		color: $ELText;
	}


	.property-list > .property {
		display: block;
	}

	.property.inline {
		.label {
			display: inline-block;
			line-height: 1;
			vertical-align: middle;
		}
		.value {
			display: inline-block;
			vertical-align: middle;
		}
	}
	
	.EL {
		cursor: pointer;

		&:hover {
			background: #eee;
		}
	}

	.top-blocks td {
		width: 33%;
	}

	.contents {
		margin-top: 10px;
		border-top: 1px solid #ddd;
		padding-top: 5px;
	}

	.block {
		margin: 20px 0;
	}

	.supsection {
		border-bottom: 1px solid #ddd;

		> label {
			border-bottom: 1px solid #ddd;
			padding-bottom: 5px;
		}
	}

	label {
		display:block;
		font-weight: bold;
		font-size: 80%;
	}

	.protection label {
		display: inline;
	}

	.synonyms {
		font-size: 80%;
		color: #aaa;
	}

	.chemical {
		padding: 5px 20px;
		transition: all .2s;
	}

	@media screen and (max-width: 600px) {

		.chemical {
			padding: 5px 10px;

			.contents {
				margin-top: 5px;
			}
		}

		.chemical.opentrue {
			padding: 5px 10px;
		}
	}

	.openfalse {
		.contents {
			display: none;
		}
	}

	.opentrue {
		background: #fff; 
		margin: 5px 0;
		padding: 10px 20px;
		box-shadow: 1px 1px 10px #00000011;

		.contents {
			display: block;
		}
	}

	table { 
		width: 100%;
		border-spacing: 10px;
	}

	.form {
		table {
			border-collapse: collapse;
			td {
				vertical-align: top;
				border: 1px solid #ddd;
				padding: 0;
				/*padding: 10px;*/
			}
			th {
				text-align: left;
				vertical-align: bottom;
				border: 1px solid #ddd;
				padding: 10px;
			}
		}
	} 

	.equation {
		text-align: center;


		> div {
			display: inline-block;
			margin: 0 3px;
			vertical-align: middle;
		}

		.operand {
			.value, .unit {
				display: block;
				text-align: center;
			} 
			.unit {
				color: #666;
				line-height: 1.2;
				font-size: 90%;
			}
		}

		.operator {
			font-size: 120%;
		}
	}

</style>

<script>

	import UnitRepresentation from 'lib/UnitRepresentation.html'
	import PersistentWrite from 'lib/PersistentWrite.html'

	export default {
		components: {
			UnitRepresentation,
			PersistentWrite
		},
		data() {
			return {
				// open: false,
				path: [],
				// forms: 
				standardsPretty: {
					osha_pel: "OSHA PEL",
					cal_osha_pel: "Cal/OSHA PEL 8-hour TWA",
					niosh_rel: "NIOSH REL Up to 10-hour TWA"
				},
				durationsPretty: {
					regular: "Standard",
					ceiling: "Ceiling",
					stel: "STEL"
				}
			}
		}
	}

</script>
