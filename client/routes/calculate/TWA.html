
<div class="description content" style="margin-top: 20px">

<ol>
	<li>Use buttons below to enter sample information . </li>
	<li>Press Calculate button to get TWA </li>
</ol>

<p>NOTE ON HOURS: Take into account time when workers were NOT exposed to the hazard (for instance, on breaks). If a sample was taken at 11am and then again at 2pm, but the lunch hour was between 12pm and 1pm, the sample taken at 11am only represents 2 hours. </p>
	
</div>

<table>
	<thead>
		<tr>
			<th></th><th>PPM <br>Measured</th><th></th><th>Hours <br>Represented</th>
		</tr>
	</thead>
	<tbody>

	{ #each samples as sample, i }
		<tr class="sample">
			<td><label>Sample {i + 1}</label></td>
			<td><input type="text" bind:value="sample.ppm" placeholder="0" /></td>
			<td>x</td>
			<td><input type="text" bind:value="sample.hours" placeholder="0" /></td>
		</tr>
	{ /each }
		
	</tbody>
</table>


<h3>TWA Equation:</h3>

<div class="equation">

	<div class="operand">
		<div class="value">{totalppmhours}</div>
		<div class="unit">Total <br>PPM-hours</div>
	</div>

	<div class="operator">&#247;</div>

	<div class="operand">
		<div class="value">{totalhours}</div>
		<div class="unit">Total <br>hours</div>
	</div>

	<div class="operator">=</div>

	<div class="operand">
		<div class="value">{twa}</div>
		<div class="unit">TWA</div>
	</div>

</div>


<style>

	@import 'colors';

	table {
		margin: 20px auto;

		th {
			font-weight: normal;
			color: #666;
			line-height: 1.2;
			font-size: 90%;
		}

		.sample {

			label {
				font-size: 90%;
				font-weight: bold;
				color: $blue2;
			}

			input {
				display: inline-block;
				font-size: 110%;
				margin: 0 10px;
				width: 60px;
				line-height: 40px;
				padding: 0 10px;
				border: 1px solid #aaa;
			}

		}
	}

	h3 {
		text-align: center;
	}

	.equation {
		text-align: center;

		> div {
			display: inline-block;
			margin: 0 6px;
			vertical-align: middle;
		}

		.operand {
			.value, .unit {
				display: block;
				text-align: center;
			}

			.value {
				font-size: 150%;
			}
			.unit {
				color: #666;
				line-height: 1.2;
				font-size: 90%;
			}
		}

		.operator {
			font-size: 120%;
		}
	}

</style>


<script>

export default {
	computed: {
		totalppmhours: ({ samples }) => { 
			var total = 0;
			for(var sample of samples) {
				if(!isNaN(sample.ppm) && !isNaN(sample.hours)) {
					total += sample.ppm * sample.hours
				}
			}
			return total
		},
		totalhours: ({ samples }) => { 
			var total = 0;
			for(var sample of samples) {
				if(!isNaN(sample.hours)) {
					total += Number(sample.hours)
				}
			}
			return total
		},
		twa: ({ totalppmhours, totalhours }) => (Math.round((totalppmhours / totalhours) * 100) / 100) || 0 // round to 2 decimal places
	}
}

</script>