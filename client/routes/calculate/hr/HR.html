
<div class="description content" style="margin-top: 20px">

<ol>
	<li>Enter the time-weighted average (TWA) for the contaminant </li>
	<li>Enter the NIOSH REL or other applicable exposure limit. </li>
	<li>Press the Calculate button to calculate Hazard Ratio </li>
</ol>

<p>NOTE: The TWA and exposure limit values MUST have the same hourly base (if an 8 hr TWA, then the exposure limit should be for 8 hrs).</p>
	
</div>

<div class="save-value live{ $job.hr == hr}">
	<div class="legend-cont"><div class="legend"> HR </div></div>

	<div class="equation">

		<div class="operand">
			
			<div class="read-value livetrue">
				<div class="legend-cont"><div class="legend"> TWA </div></div>
					{ #if $job.twa }
						{ $job.twa }
					{ :else }
						No TWA set yet!
					{ /if }
				<div class="button-cont"><a class="button edit" href="{ asr.makePath(valueSources['twa']) }"> Edit </a></div>
			</div>

		</div>

		<div class="operator">&#247;</div>

		<div class="operand">

			<div class="read-value">
				<div class="legend-cont"><div class="legend"> Exposure Limit </div></div>
					{ #if $job.exposureLimit.value }
						<div class="representation">
							{ $job.exposureLimit.value }
							<div class="unit">{ @html $job.exposureLimit.unit }</div>
						</div>
					{ :else }
						No exposure limit selected yet!
					{ /if }
				<div class="button-cont"><a class="button edit" href="{ asr.makePath(valueSources['exposureLimit']) }"> Edit </a></div>
			</div>

		</div>

		<div class="operator">=</div>

		<div class="operand HR">
			<div class="value">{ round(hr) }</div>
			<div class="unit">HR</div>
		</div>

	</div>

	<div class="button-cont"><div class="button valid{ valid }" on:click="setHR()"> { $job.hr == hr ? 'Current' : 'Save' } HR  </div></div>

</div>

<script>

import { number, round } from 'lib/util.js'
import { valueSources } from 'lib/storage.js'

export default {
	components: {
		ExposureLimits: 'lib/ExposureLimits.html'
	},
	methods: {
		setHR() {
			let state = this.get()
			if(state.valid) {
				this.store.set({ job: { hr: state.hr } })
			}
		}
	},
	data: () => ({
		exposureLimit: '',
		twa: '',
		valueSources
	}),
	computed: {
		valid: ({ $job }) => !!(number($job.twa) && number($job.exposureLimit.value)),
		hr: ({ $job, valid }) => valid ? (number($job.twa) / number($job.exposureLimit.value)) : 0
	},
	helpers: {
		round
	}
}

</script>

<style>

	@import 'colors';

	.save-value {
		display: table;
		margin: 0 auto;
	}

	.read-value {
		margin: 10px 0 20px 0;
	}

</style>
